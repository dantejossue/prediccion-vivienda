<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Estimador de Precio de Propiedad</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <div class="overlay">
    <h2>Estimador de Precio de Propiedad</h2>
    <form id="formulario" autocomplete="off">
      <label for="metros">Metros cuadrados</label>
      <div class="input-group">
        <i class="fas fa-ruler-combined"></i>
        <input type="number" id="metros" required />
      </div>

      <label for="habitaciones">Número de habitaciones</label>
      <div class="input-group">
        <i class="fas fa-bed"></i>
        <input type="number" id="habitaciones" required />
      </div>

      <label for="banos">Número de baños</label>
      <div class="input-group">
        <i class="fas fa-bath"></i>
        <input type="number" id="banos" required />
      </div>

      <label for="localidad">Localidad</label>
      <div class="input-group" style="flex-direction: column; align-items: stretch;">
        <div style="display: flex; align-items: center;">
          <i class="fas fa-map-marker-alt"></i>
          <input type="text" id="localidad" placeholder="Ej: Miraflores" required />
        </div>
        <div class="suggestions" id="suggestions"></div>
      </div>

      <button type="submit">Estimar Precio</button>
    </form>

    <div class="resultado" id="resultado" style="display: none;"></div>
  </div>

  <script>
    const localidades = [
      "La Molina",
      "Miraflores",
      "San Isidro",
      "Surco",
      "Barranco",
      "Chorrillos",
      "Pueblo Libre",
      "Jesus Maria",
      "San Borja",
      "San Miguel"
    ];

    const localidadInput = document.getElementById('localidad');
    const suggestionsBox = document.getElementById('suggestions');

    localidadInput.addEventListener('input', function () {
      const input = this.value.toLowerCase();
      suggestionsBox.innerHTML = '';
      if (input.length === 0) return;

      const coincidencias = localidades.filter(loc =>
        loc.toLowerCase().includes(input)
      );

      coincidencias.forEach(loc => {
        const item = document.createElement('div');
        item.textContent = loc;
        item.onclick = () => {
          localidadInput.value = loc;
          suggestionsBox.innerHTML = '';
        };
        suggestionsBox.appendChild(item);
      });
    });

    document.addEventListener('click', function (e) {
      if (!e.target.closest('.input-group')) {
        suggestionsBox.innerHTML = '';
      }
    });

    document.getElementById('formulario').addEventListener('submit', function (e) {
      e.preventDefault();

      const metros = parseFloat(document.getElementById('metros').value);
      const habitaciones = parseInt(document.getElementById('habitaciones').value);
      const banos = parseInt(document.getElementById('banos').value);
      const localidad = document.getElementById('localidad').value.trim();

      let precioBase = metros * 500;
      precioBase += habitaciones * 8000;
      precioBase += banos * 6000;

      let factor = 1.0;
      if (localidad.toLowerCase() === "miraflores") factor = 1.2;
      else if (localidad.toLowerCase() === "san isidro") factor = 1.3;
      else if (localidad.toLowerCase() === "surco") factor = 1.1;
      else if (localidad.toLowerCase() === "la molina") factor = 1.0;

      const precioFinal = precioBase * factor;

      const resultado = `
        <h3>Resultado de la Estimación</h3>
        <p><strong>Metros cuadrados:</strong> ${metros}</p>
        <p><strong>Habitaciones:</strong> ${habitaciones}</p>
        <p><strong>Baños:</strong> ${banos}</p>
        <p><strong>Localidad:</strong> ${localidad}</p>
        <p class="precio"><strong>Precio estimado:</strong> $${precioFinal.toLocaleString()} USD</p>
      `;

      const divResultado = document.getElementById('resultado');
      divResultado.innerHTML = resultado;
      divResultado.style.display = 'block';
    });
  </script>
</body>
</html>